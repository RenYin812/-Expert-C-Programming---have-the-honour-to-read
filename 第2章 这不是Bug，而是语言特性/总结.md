__太空软件的故事__

语言的细节决定了一种语言到底是可靠的还是容易滋生错误的。

在C语言中，也存在太多含糊之处或近似含糊之处。分析编程语言缺陷的一种方法是把所有的缺陷归于3类：“多做之过”、“误做之过”、“少做之过”。

__多做之过__

“多做之过”就是语言中存在某些不应该存在的特性，这些特性包括容易出错的switch语句、相邻字符串常量的自动连接、缺省全局作用域。

__一.容易出错的switch语句__

__1.__ 由于存在fall through，switch语句会带来麻烦

__(1)__ 一个遵循标准的C编译器至少允许一条switch语句中有257个case标签，这是为了允许switch满足一个8比特字符的所有情况（256个可能的值加EOF）。

__(2)__ default可以出现在case列表的任何位置，但习惯上总把default放在最后，它在其他的case均无法匹配时被选中执行。但如果没有default且所有的
case均不匹配，则整条switch语句便什么也不做。<br>
在C语言中，几乎从来不进行运行时错误检查（对进行解除引用操作的指针进行有效性检查大概是唯一的例外）。<br>
运行时检查与C语言的设计理念相违背，按照C的理念，程序员应该知道自己正在干什么，而且保证自己的所作所为是正确的。

__(3)__ switch存在一些问题，其中之一就是对case可能出现的值太过于放纵了，例如可以在switch的左花括号之后声明一些变量，从而进行一些局部存储的分配。<cr>
在switch语句中为这些变量加上初始值没有什么用处，因为它绝不会被执行---语句从匹配表达式的case开始执行。
  
__(4)__switch的另一个问题是它内部的任何语句都可以加上标签，并在之执行时跳转到那里，这就有可能破坏程序流的结构化<br>
所有的case都是可选的，任何形式的语句---包括带标签的语句都是允许的，这就意味着有些错误甚至连lint程序也可能无法检测出来。如把default中的字母l打成数字1，它的
实际效果相当于default子句根本不存在于switch语句中，但是它能顺利通过编译不会显示错误。<br>
int i;<br>
switch(i)<br>
{<br>
  case 5+3:do_again:<br>
  case 2:printf("I loop unremittingly\n"); doto do_again;<br>
  defau1t: i++;<br>
  case 3: ;<br>
}<br>
  
__小启发__

__1.__ 无论什么时候，如果遇见类似malloc(strlen(str));的语句，几乎可以断定它是错误的，因为其他字符串处理库函数几乎都包含一个额外空间，用于容纳字符串结尾的空字符，而
strlen是个例外。

__2.__<br>
一个“L”的NUL用于结束一个ASCII字符串，ASCII字符串中零的位模式被称为“NUL”；<br>
两个“L”的NULL用于表示什么也不指向（空指针），是一个指针值。
